# 版本控制规范

无论你在设计什么系统，也不管你事先做了多么详尽的计划，随着时间的推移和业务的发展，你的程序总会发生变化，数据关系也会发生变化，资源可能会被添加或者删除一些属性。只要软件还在生存期内并且还有人在用它，开发人员就得面对这些问题，对于API设计来说，尤其如此。

API是一份调用方（Consumer）和服务器之间已达成的契约，更改服务器的API必然会影响其向后兼容性，对契约的破坏将会招致使用方（Consumer）的抱怨，如果你改动很大，他们可能会放弃使用你的服务。为了确保服务器程序能够进化升级，同时能够让使用方感到满意，你需要在引入新版本API的同时继续让旧版本的API正常工作。

过一段时间之后，你可以告诉调用方不建议（deprecate）使用旧版本。不建议使用一个API并不意味着马上就要关闭它或者降低它的服务质量，而是告诉你的API使用人员他们需要版本升级，旧的版本将在未来一段时间之后被停止服务。

在URL中加入版本号是一个优秀的API设计，当然还有另一个常用的解决办法就是把版本号放在请求首部中，但不如放入URL方便和直观。Github采用这种做法。

### 1.版本规范

应该将API的版本号放入URL。

```
https://api.example.com/{endpoint}/v{n}/
```

采用多版本并存，增量发布的方式

v{n} n代表版本号,分为整形和浮点型

整形的版本号: 大功能版本发布形式；具有当前版本状态下的所有API接口 ,例如：v1,v2

浮点型：为小版本号，只具备补充api的功能，其他api都默认调用对应大版本号的api 例如：v1.1 v2.2

### 2.多端/外部版本

基于BBF的思路，在版本处定义多端：

如标准web调用： /v1/

移动端调用： /mobi@v1/

内部API调用：/ service@v1/   /api@v1/

也可参考：cdn的版本方案  /{api端点}/{mobi\|service}@{版本}/{资源描述}  引入@标记。

### 



